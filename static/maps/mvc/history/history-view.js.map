{"version":3,"file":"history-view.js","sources":["../../../src/mvc/history/history-view.js"],"names":["define","LIST_VIEW","HISTORY_MODEL","HISTORY_CONTENTS","HDA_LI","HDCA_LI","USER","faIconButton","PopupMenu","BASE_MVC","_l","logNamespace","HistoryPrefs","SessionStorageModel","extend","defaults","expandedIds","show_deleted","show_hidden","addExpanded","model","key","this","save","_","get","object","id","removeExpanded","omit","toString","storageKeyPrefix","historyStorageKey","historyId","Error","clearAll","sessionStorage","indexOf","removeItem","_super","ModelListPanel","HistoryView","_logNamespace","HDAViewClass","HDAListItemView","HDCAViewClass","HDCAListItemView","collectionClass","HistoryContents","modelCollectionKey","tagName","className","prototype","emptyMsg","noneFoundMsg","searchPlaceholder","initialize","attributes","call","linkTarget","freeModel","clearUpdateTimeout","_setUpListeners","on","error","xhr","options","msg","details","errorHandler","loading-done","views","length","trigger","views:ready view:attached view:removed","_renderSelectButton","loadHistoryWithDetails","historyFn","contentsFn","info","detailIdsFn","historyData","values","loadHistory","panel","History","getHistoryData","initiallyExpanded","_loadHistoryFromXHR","fail","where","history","always","then","historyJSON","contentsJSON","JSONToModel","render","refreshContents","refresh","$","when","newHistoryJSON","newHdaJSON","log","setModel","_setUpWebStorage","storage","stopListening","isObject","set","isBoolean","listenTo","change:show_deleted","view","newVal","showDeleted","change:show_hidden","showHidden","undefined","_buildNewRender","$newRender","$where","$el","multiselectActions","hideSelectors","find","remove","$existing","size","title","classes","faIcon","prependTo","_getItemViewClass","contentType","TypeError","_filterItem","hidden","isDeletedOrPurged","_getItemViewOptions","expanded","hasUser","ownedByCurrUser","_setUpItemViewListeners","v","collapsed","getSelectedModels","collection","events","clone","click .show-selectors-btn","click .messages [class$=message]","toggleShowDeleted","show","store","renderItems","toggleShowHidden","_firstSearch","searchFor","inputSelector","contents","haveDetails","searchItems","searchInput","fetchAllDetails","silent","done","status","readyState","parsed","_parseErrorMessage","$messages","is","displayMessage","message","once","user","Galaxy","_bePolite","raven","window","Raven","isFunction","lastEventId","agent","navigator","userAgent","url","lastAjax","data","source","toJSON","User","getAllResponseHeaders","responseHeaders","compact","split","map","header","type","scrollToTop","$msgContainer","$msg","addClass","html","isEmpty","$detailsLink","click","modal","_messageToModalOptions","append","functions","text","JSON","stringify","pre","body","buttons","Ok","hide","clearMessages","ev","$target","isUndefined","children","currentTarget","fadeOut","fxSpeed","scrollToHid","hid","scrollToItem","first","viewsWhereModel","templates","controlsTemplate","wrapTemplate","controls"],"mappings":"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"}